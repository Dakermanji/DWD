<!-- views/layouts/_navBar.ejs -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
  <div class="container">
    <a class="navbar-brand" href="/" aria-label="<%= t('nav.home')
			%>" ><%- include('_company_name') %></a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="<%= t('nav.toggle')
			%>">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav <%= lang === 'ar' ? 'me-auto' : 'ms-auto' %>">
        <% if (navBar.length > 0) { %>
        <% navBar.forEach(nav => {%>
        <li class="nav-item">
          <a class="nav-link <%= currentRoute === `${nav.link}` ? 'active' : '' %>" <%= nav.id ? `id="${nav.id}"` : '' %> href="<%= nav.link %>" aria-label="<%= t(nav.label) %>">
            <span class="nav-icon" data-bs-toggle="tooltip" title="<%= t(nav.label) %>"><i class="bi <%= nav.icon %>"></i></span>
            <span class="nav-text"><%= t(nav.label) %></span>
          </a>
        </li>
        <% })} %>
        <% if (!user) { %>
          <li class="nav-item">
            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#authModal">
              <i  data-bs-toggle="tooltip" title="<%= t('auth.login') %> / <%= t('auth.register') %>" class="bi bi-box-arrow-in-right"></i> <span class="nav-text"><%= t('auth.login') %> / <%= t('auth.register') %></span>
            </a>
          </li>
        <% } else { %>
          <li class="nav-item">
            <a class="nav-link <%= currentRoute === "/dashboard" ? 'active' : '' %>"
              id="dashboard"
              href="/dashboard"
              aria-label="<%= t('nav.account') %>">
              <span
                class="nav-icon"
                data-bs-toggle="tooltip"
                title="<%= t('nav.account') %>"
                ><i class="bi bi-person-circle"></i>
              </span>
              <span class="nav-text"><%= t('dashboard.title') %></span>
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link" id="socialToggle" aria-label="<%= t('nav.social') %>">
              <span class="nav-icon" data-bs-toggle="tooltip" title="<%= t('nav.social') %>">
                <i class="bi bi-people-fill"></i>
              </span>
              <span class="nav-text"><%= t('nav.social') %></span>
            </a>
          </li>
          <li class="nav-item">
            <form action="/auth/logout" method="POST" class="d-inline">
              <button type="submit" class="btn btn-link nav-link" data-bs-toggle="tooltip" title="<%= t('auth.logout') %>">
                <i class="bi bi-box-arrow-right"></i> <span class="nav-text"><%= t('auth.logout') %></span>
              </button>
            </form>
          </li>
        <% } %>
        <li class="nav-item dropdown">
          <a class="nav-link" href="#" id="langDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            <% const currentLang = supportedLanguages.find(l => l.code === lang); %>
            <img src="/images/flags/<%= currentLang?.flag || 'ca' %>.svg" alt="<%= lang.toUpperCase() %>" width="20" height="15" class="mx-1"><%= lang === 'ar' ? 'عربي' : lang.toUpperCase() %>
          </a>
          <ul class="lang dropdown-menu <%= lang === 'ar' ? 'dropdown-menu-start' : 'dropdown-menu-end' %>" aria-labelledby="langDropdown">
            <% supportedLanguages.forEach(l => { %>
              <li class="lang">
                <a class="dropdown-item d-flex justify-content-between" href="/lang/<%= l.code %>?returnTo=<%= encodeURIComponent(currentUrl) %>">
                  <span><img src="/images/flags/<%= l.flag %>.svg" alt="<%= l.code.toUpperCase() %>" width="20" height="15" class="me-1"></span>
                  <span><%= l.name %></span>
                </a>
              </li>
            <% }) %>
          </ul>
        </li>
      </ul>
    </div>

  </div>
</nav>
